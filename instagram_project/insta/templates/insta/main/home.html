
{% extends "insta/main/base.html" %}

{% block damn %}
<form class="" method="get">
  <input type="search" class="input fu" name="search" value="">

  <button type="submit" name="button" class="btn ffff ">

    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-search" viewBox="0 0 16 16">
      <path d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z"/>
    </svg>

  </button>
</form>
{% endblock %}
{% block content %}
{% load my_extras %}
  {% if search %}
  <ul class="dd">
  {% for u in search %}
    {% if u.display_picture %}
    <div class="row" style="margin-bottom:5px;">
      <div class="col-md-2">
        <img src="{{u.display_picture.url}}" class="round_" alt="">
      </div>
      <div class="col-md-10">

        <li class="sl"><a href="{% url "insta:user_profile" pk=u.pk %}">{{u.user_name}}</a></li>
        <div class="row">
          <div class="col-md-12">
            <li class="sh">{{u.full_name}}</li>

          </div>
        </div>
      </div>
    </div>
    {% else %}
    <div class="row" style="margin-bottom:5px;">
      <div class="col-md-2">
        #
      </div>
      <div class="col-md-10">

        <li class="sl"><a href="{% url 'insta:hash' pk=u.pk %}">{{u.page}}</a></li>
      </div>
    </div>
    {% endif %}

  {% endfor %}
  </ul>
  {% endif %}
    <!-- stories -->
      <div class="row">
        <div class="col-md-2 d">
  
        </div>
        <div class="col-md-6 d" style="margin-top:40px;">
          <div class="card body_card " style="height:99px;">
              <div class="card-body h">
                {% for st in story %}
                <a href="{% url 'insta:story' pk=st.pk %}">
                  <img src="{{st.author.display_picture.url}}" style="margin:10px 5px ; height:62px; width:62px; border-radius:50%; border:2px solid purple; padding:2px;">
                </a>
                {% endfor %}
              
              </div>
          </div>
          {% for f in hell %}
            <br>
            <div class="card body_card ">
              <div class="card-body h">
                <div class="row">
                  <div class="col-md-7">
                    <p class="m">
                      <a href='{% url "insta:user_profile" pk=f.author.pk %}'>
                        {% if f.author.display_picture|check %}
                          <img class="adjust" src="{{f.author.display_picture.url}}"  alt="">
                        {% endif %}
                      </a>

                      <span class="lefte">{{f.author}}</span>

                    </p>

                  </div>
                  <div class="col-md-5 align">
                    <span class="yo">
                      <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-three-dots" viewBox="0 0 16 16">
                        <path d="M3 9.5a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3zm5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3zm5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3z"/>
                      </svg>
                    </span>
                  </div>
                </div>

              </div>
            </div>
            <div class="card mb-3 body_card">
              <img class="card-img-top i" style="image-rendering: crisp-edges;filter: contrast(150%);" src="{{f.picture.url}}" alt="Card image cap">

              <div class="card-body z">
                <ul class="flex">
                  <li>
                    <!-- <h1>{{f.likes.all}}</h1> -->
                    {% if likes|lis:forloop.counter %}
                      <a class="nav-link active leftpad like" aria-current="page" href="{% url "insta:unlike" pk=f.pk %}">
                        <svg  xmlns="http://www.w3.org/2000/svg" width="29" height="24" fill="currentColor" class="bi bi-heart" viewBox="0 0 16 16">
                          <path d="M8 2.748l-.717-.737C5.6.281 2.514.878 1.4 3.053c-.523 1.023-.641 2.5.314 4.385.92 1.815 2.834 3.989 6.286 6.357 3.452-2.368 5.365-4.542 6.286-6.357.955-1.886.838-3.362.314-4.385C13.486.878 10.4.28 8.717 2.01L8 2.748zM8 15C-7.333 4.868 3.279-3.04 7.824 1.143c.06.055.119.112.176.171a3.12 3.12 0 0 1 .176-.17C12.72-3.042 23.333 4.867 8 15z"/>
                        </svg>
                      </a>
                    {% else %}
                      <a class="nav-link active leftpad" aria-current="page" href="{% url "insta:like" pk=f.pk %}">
                        <svg  xmlns="http://www.w3.org/2000/svg" width="29" height="24" fill="currentColor" class="bi bi-heart" viewBox="0 0 16 16">
                          <path d="M8 2.748l-.717-.737C5.6.281 2.514.878 1.4 3.053c-.523 1.023-.641 2.5.314 4.385.92 1.815 2.834 3.989 6.286 6.357 3.452-2.368 5.365-4.542 6.286-6.357.955-1.886.838-3.362.314-4.385C13.486.878 10.4.28 8.717 2.01L8 2.748zM8 15C-7.333 4.868 3.279-3.04 7.824 1.143c.06.055.119.112.176.171a3.12 3.12 0 0 1 .176-.17C12.72-3.042 23.333 4.867 8 15z"/>
                        </svg>
                      </a>

                    {% endif %}


                  </li>
                  <li>
                    <a class="nav-link active leftpad" aria-current="page" href="{% url "insta:detail" pk=f.pk %}">
                      <svg xmlns="http://www.w3.org/2000/svg" width="29" height="24" fill="currentColor" class="bi bi-chat" viewBox="0 0 16 16">
                        <path d="M2.678 11.894a1 1 0 0 1 .287.801 10.97 10.97 0 0 1-.398 2c1.395-.323 2.247-.697 2.634-.893a1 1 0 0 1 .71-.074A8.06 8.06 0 0 0 8 14c3.996 0 7-2.807 7-6 0-3.192-3.004-6-7-6S1 4.808 1 8c0 1.468.617 2.83 1.678 3.894zm-.493 3.905a21.682 21.682 0 0 1-.713.129c-.2.032-.352-.176-.273-.362a9.68 9.68 0 0 0 .244-.637l.003-.01c.248-.72.45-1.548.524-2.319C.743 11.37 0 9.76 0 8c0-3.866 3.582-7 8-7s8 3.134 8 7-3.582 7-8 7a9.06 9.06 0 0 1-2.347-.306c-.52.263-1.639.742-3.468 1.105z"/>
                      </svg>
                    </a>
                  </li>
                  <li>
                    <a data-bs-toggle="modal" data-bs-target="#exampleModal" class="nav-link active leftpad" aria-current="page" href="#">
                      <svg xmlns="http://www.w3.org/2000/svg" width="29" height="24" fill="currentColor" class="bi bi-telegram" viewBox="0 0 16 16">
                        <path d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zM8.287 5.906c-.778.324-2.334.994-4.666 2.01-.378.15-.577.298-.595.442-.03.243.275.339.69.47l.175.055c.408.133.958.288 1.243.294.26.006.549-.1.868-.32 2.179-1.471 3.304-2.214 3.374-2.23.05-.012.12-.026.166.016.047.041.042.12.037.141-.03.129-1.227 1.241-1.846 1.817-.193.18-.33.307-.358.336a8.154 8.154 0 0 1-.188.186c-.38.366-.664.64.015 1.088.327.216.589.393.85.571.284.194.568.387.936.629.093.06.183.125.27.187.331.236.63.448.997.414.214-.02.435-.22.547-.82.265-1.417.786-4.486.906-5.751a1.426 1.426 0 0 0-.013-.315.337.337 0 0 0-.114-.217.526.526 0 0 0-.31-.093c-.3.005-.763.166-2.984 1.09z"/>
                      </svg>
                    </a>

                  </li>
                  <!-- bookamrk -->
                  {% if f in user.saved.all %}
                  <a class="nav-link active leftpad lefter saved" aria-current="page" href="{% url "insta:unsave" pk=f.pk %}">
                  {% else %}
                  <a class="nav-link active leftpad lefter" aria-current="page" href="{% url "insta:save" pk=f.pk %}">
                  {% endif %}
                      <svg xmlns="http://www.w3.org/2000/svg" width="29" height="24" fill="currentColor" class="bi bi-bookmark" viewBox="0 0 16 16">
                        <path d="M2 2a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v13.5a.5.5 0 0 1-.777.416L8 13.101l-5.223 2.815A.5.5 0 0 1 2 15.5V2zm2-1a1 1 0 0 0-1 1v12.566l4.723-2.482a.5.5 0 0 1 .554 0L13 14.566V2a1 1 0 0 0-1-1H4z"/>
                      </svg>
                    </a>
                  </li>
                </ul>
                <form method="get">
                  {% csrf_token %}
                  <label for="chat">To</label>
                  <input type="search" name="chat" value="">
                  <input type="hidden" name="hide" value="{{f.pk}}">
                </form>
                {% if f.pk|c:post_pk %}
                {% for c in chat_user %}
                    <a href="{% url "insta:post_chat" pk=f.pk  username=c.user_name %}">{{c.user_name}}</a>
                {% endfor %}
                {% endif %}
                <p class="card-text"><span class="bold">{{f.author}}

                </span>:<span class="space"> 
                {% for ha in f.text|split %}
                {% if ha|chg %}
                  <a  style="color:blue;" href="{% url 'insta:hash' pk=ha|hasher %}">{{ha}}</a>
                {% else %}
                {{ha}}
                {% endif %}
                {% endfor %}
                
                <br>
                <br>
              </span>

                  {% for tag in f.tag.all %} 
                  <a style="color:blue;" href="{%  url "insta:user_profile" pk=tag.pk %}">@{{tag.user_name}}</a>
                  {% endfor %}
                </p>
                <p>View all {{comments|li:forloop.counter}} comments</p>
                {% for comment in comments|lis:forloop.counter %}
                  {% if forloop.counter <= 2 %}
                  <p><span class="bold">{{comment.author}}</span><span class="space">{{comment.text}}</span>  </p>
                  {% endif %}
                {% endfor %}
                <p class="card-text"><small class="text-muted">Posted on: {{f.time|date:'d M, Y '}}</small></p>
                <hr>

                <form class="" method="post">
                  {% csrf_token %}
                  {{form}}
                  <input type="hidden" name="hidden" value="{{f.pk}}">
                  <button type="submit" class="btn btn-sm but" name="button">Post</button>
                </form>
              </div>
            </div>
          {% endfor %}
        </div>
        <div class="col-md-4 fq d">
          <div class="down">
            <div class="row">
              <div class="col-md-2">
                <a href="{% url "insta:user_profile" pk=user.pk %}">
                {% if user.display_picture|check %}
                  <img class="round_big" src="{{user.display_picture.url}}" alt="">
                {% else %}
                  <svg xmlns="http://www.w3.org/2000/svg" width="45" height="45" fill="currentColor" class="bi bi-person-circle" viewBox="0 0 16 16">
                    <path d="M11 6a3 3 0 1 1-6 0 3 3 0 0 1 6 0z"/>
                    <path fill-rule="evenodd" d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8zm8-7a7 7 0 0 0-5.468 11.37C3.242 11.226 4.805 10 8 10s4.757 1.225 5.468 2.37A7 7 0 0 0 8 1z"/>
                    </svg>
                {% endif %}
                </a>
                <!-- <img src="{{user.display_picture.url}}" alt="" class="round_big"> -->
              </div>
              <div class="col-md-7 ">
                <p>{{user.user_name}}
                  <br>

                  <span class="sme">{{user.full_name}}</span></p>
                <p class="sme"></p>
              </div>
              <div class="col-md-3"></div>
            </div>



            <div class="suggestions">
              <p class="s">Suggestions For You</p>
              {% for p in suggest %}
                <!-- <div class="row">
                  <p class="s ">
                    <img src="{{p.display_picture.url}}" class='rounder' alt="">
                    <span class="space">{{p.user_name}}
                      suggested for you
                    </span>
                  </p>
                </div> -->
                <div class="row">
                  <div class="col-md-2 r">
                    <a href="{% url "insta:user_profile" pk=p.pk %}">

                      {% if p.display_picture.url|check %}
                        <img src="{{p.display_picture.url}}" class="round_" alt="">
                      {% else %}
                      {{f.author}}
                          <svg xmlns="http://www.w3.org/2000/svg" width="29" height="22" fill="currentColor" class="bi bi-person-circle" viewBox="0 0 16 16">
                            <path d="M11 6a3 3 0 1 1-6 0 3 3 0 0 1 6 0z"/>
                            <path fill-rule="evenodd" d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8zm8-7a7 7 0 0 0-5.468 11.37C3.242 11.226 4.805 10 8 10s4.757 1.225 5.468 2.37A7 7 0 0 0 8 1z"/>
                          </svg>
                      {% endif %}
                    </a>
                  </div>
                  <div class="col-md-5 l">
                    <p>{{p.user_name}}
                      <br>
                      
                      <span class="sme">have {{mutual|lis:forloop.counter}} friends in common</span></p>
                    <p class="sme"></p>
                  </div>
                  <div class="col-md-5"><a  class="link" href="{% url "insta:follow" pk=p.pk %}">Follow</a></div>
                </div>
              {% endfor %}
              {% for p in b %}
                <!-- <div class="row">
                  <p class="s ">
                    <img src="{{p.display_picture.url}}" class='rounder' alt="">
                    <span class="space">{{p.user_name}}
                      suggested for you
                    </span>
                  </p>
                </div> -->
                <div class="row">
                  <div class="col-md-2 r">
                    <a href="{% url "insta:user_profile" pk=p.pk %}">
                      {% if p.display_picture.url|check %}
                      <img src="{{p.display_picture.url}}" alt="" class="round_">
                      {% else %}
                          <svg xmlns="http://www.w3.org/2000/svg" width="29" height="22" fill="currentColor" class="bi bi-person-circle" viewBox="0 0 16 16">
                            <path d="M11 6a3 3 0 1 1-6 0 3 3 0 0 1 6 0z"/>
                            <path fill-rule="evenodd" d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8zm8-7a7 7 0 0 0-5.468 11.37C3.242 11.226 4.805 10 8 10s4.757 1.225 5.468 2.37A7 7 0 0 0 8 1z"/>
                            </svg>
                      {% endif %}
                    </a>
                  </div>
                  <div class="col-md-5 l">
                    <p>{{p.user_name}}
                      <br>

                      <span class="sme">suggested for you</span></p>
                    <p class="sme"></p>
                  </div>
                  <div class="col-md-5"><a  class="link" href="{% url "insta:follow" pk=p.pk %}">Follow</a></div>
                </div>
              {% endfor %}
            </div>

          </div>
        </div>
      </div>
      <script type="text/javascript">
        var bb=document.querySelector('#staticBackdrop');
        document.addEventListener('click', function(e) {
          let container = document.querySelector('.dd');
          if (!container.contains(e.target)) {
            container.style.display ='none';
            history.pushState({}, null,"http://127.0.0.1:8000/insta/user_/");
            console.log("nonoo")


          }
        });
      </script>
{% endblock %}



<!-- all the icons are given leftpad class so chage it if there is any problem -->
